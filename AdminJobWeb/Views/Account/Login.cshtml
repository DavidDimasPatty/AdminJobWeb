@{
    Layout = null;
}

<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="~/vendor/libs/jquery/jquery.js" asp-append-version="true"></script>
    <script src="~/vendor/libs/popper/popper.js" asp-append-version="true"></script>
    <script src="~/vendor/js/bootstrap.js" asp-append-version="true"></script>
    <script src="~/vendor/libs/perfect-scrollbar/perfect-scrollbar.js" asp-append-version="true"></script>
    <script src="~/vendor/js/menu.js" asp-append-version="true"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <link href="~/css/login.css" rel="stylesheet" />
</head>
<body>
    <div class="w-100 h-100 col d-flex justify-content-center align-items-center">
        <form method="post" asp-action="Login" asp-controller="Account">

            <div class="card card-primary">
                <div class="card-header">
                    <h2>Login Admin</h2>
                </div>
                <div class="card-body">
                    <div class="row gap-3">
                        <input type="text" name="username" class="form-control" placeholder="Username Admin..." />
                        <input type="password" name="password" class="form-control" placeholder="Password Admin..." />
                    </div>
                    @if (ViewBag.loginCount != 0 && ViewBag.loginCount != null)
                    {
                        <center class="mt-2"><b class="text-danger text-center">Percobaan ke-@ViewBag.loginCount dari 5</b> </center>
                    }
                    @if (!String.IsNullOrEmpty(ViewBag.waiting))
                    {
                        <center class="mt-2" id="waitingDiv"><b class="text-danger text-center">Mohon Menunggu Sampai <p id="countDown"></p></b> </center>
                    }
                </div>
                <div class="card-footer">
                    <div class="row d-flex gap-3">
                        <input class="btn btn-info text-light" type="submit" value="Login" id="logSubmit" />
                        <a class="btn btn-danger" href="/Account/ResetPassword">Reset Password</a>
                    </div>
                </div>

            </div>
        </form>
    </div>
</body>
</html>

<script>

    if ("@ViewBag.waiting" != "") {
        $("#logSubmit").attr("disabled", true);
        var minutes = @ViewBag.diffMin;
        var seconds = @ViewBag.diffSec;
        var countDownDate = new Date(Date.now() + ((minutes * 60 + seconds) * 1000));
        var x = setInterval(function () {
            var now = new Date().getTime();
            var distance = countDownDate - now;
            var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            var seconds = Math.floor((distance % (1000 * 60)) / 1000);
            document.getElementById("countDown").innerHTML = minutes + "m " + seconds + "s ";
            if (distance < 0) {
                clearInterval(x);
                $("#logSubmit").attr("disabled", false);
                $("#waitingDiv").hide();
            }
        }, 1000);
    }
</script>